
<script type="text/ng-template"
    id="report/_whereConditionTip.html">
    <span><a href="https://docs.google.com/a/wandoujia.com/document/d/1qVbj6d_lHIuFKzxnSPchCAZHtzkJX069EzZ2cJe3-o4/edit" target="_blank">预定义日期变量说明</a></span>
</script>

<script type="text/ng-template"
    id="report/_validateMetric.html">
    <input type="text" name="validate-metric" ng-model="_validateMetric" style="display: none"
        multi-choose-checker-error-message="Metrics 数量应该 <= 10"
        validator="multiChooseChecker" key="metricList" gt="0" lt="4">
</script>

<script type="text/ng-template"
    id="report/_validateDimension.html">
    <input type="text" name="validate-dimension" ng-model="_validateDimension" style="display: none"
        multi-choose-checker-error-message="Dimensions都可以选择，一次只能选不大于3个"
        validator="multiChooseChecker" key="dimensionList" gt="0" lt="11">
</script>

<script type="text/ng-template"
    id="report/add_report/period.html">
    <label for="hour" style="display: none;">Hour
        <input type="checkbox" value="1" name="hour"
            validator="periodChooser" ng-model="formlyData.hour">
    </label>
    <label for="day">Day
        <input type="checkbox" value="1" name="day" ng-model="formlyData.day">
    </label>
</script>

<script type="text/ng-template"
    id="report/add_metric/expression.html">

    <div class="control-group x-control-stack-select">
        <label class="control-label">
            Metric Expression
        </label>
        <div class="controls">
            <select name="metric_id1"
                id="metric_id1" ng-model="formlyData.metricId1"
                ng-options="opt.id as opt.name for opt in metricList"></select>
            <br>
            <select validator="required" name="operator" style="width: 50px"
                id="operator" ng-model="formlyData.operator" required
                ng-options="$index as opt for opt in metricOperators"></select>
            <br>
            <select validator="required" name="metric_id2"
                id="metric_id2" ng-model="formlyData.metricId2" required
                ng-options="opt.id as opt.name for opt in metricList"></select>
            <p class="i-form-help-block">
                <span class="w-text-warning">{{expressionErr}}</span>
            </p>
        </div>
    </div>
</script>

<script type="text/ng-template"
    id="report/add_metric/fileds.html">
    <table class="table table-striped">
        <tr>
            <th>Name</th>
            <th>Id</th>
            <th>Type</th>
        </tr>
        <tr ng-repeat="item in optionalFileds">
            <td>{{item.name}}</td>
            <td>{{item.id}}</td>
            <td>{{item.type}}</td>
        </tr>
    </table>
</script>

<script type="text/ng-template"
    id="report/add_dimension/fields.html">
    <ui-select ng-model="formlyData.field">
      <ui-select-match placeholder="Select or search in the list...">{{$select.selected.name}}</ui-select-match>
      <ui-select-choices repeat="opt in formFields[0].options | filter: {name: $select.search}">
      <!-- person in people | propsFilter: {name: $select.search, age: $select.search} -->
        <!-- <span ng-bind-html="item.name | highlight: $select.search"></span> -->
        <span>{{opt.name}}</span>
      </ui-select-choices>
    </ui-select>
</script>

<script type="text/ng-template"
    id="report/metric-tabs-modal.html">

    <div class="modal-header">
        <button type="button" class="close" ng-click="$close()"
            data-dismiss="modal" aria-hidden="true">×</button>
        <h3 class="modal-title">Add Metric</h3>
    </div>

    <div class="modal-body">
        <tabset>
            <tab heading="Normal Metric" select="$root.currentMetricTab = 'normal_metric'">
                <div ng-controller="metricModalCtrl" id="normal_metric">
                    <formly-form fields="formFields" key="{{formName}}"></formly-form>
                </div>
            </tab>
            <tab heading="Combine Metric" select="$root.currentMetricTab = 'combine_metric'">
                <div ng-controller="combinedMetricModalCtrl" id="combine_metric">
                    <formly-form fields="formFields" key="{{formName}}"></formly-form>
                </div>
            </tab>
        </tabset>
    </div>

    <div class="modal-footer">
        <a target="_blank">
            <i class="icon-question-sign modal-help"
                rel="tooltip" data-placement="right"
                data-original-title="Help Document">
            </i>
        </a>
        <button class="btn"
            data-dismiss="modal" ng-click="$close()">
            Close
        </button>
        <button class="btn btn-primary"
            formly-submit="formly" ng-click="submit()" target="{{currentMetricTab}}">
            Save Changes
        </button>
    </div>
</script>

<script type="text/ng-template"
    id="report/dimen-adv-modal.html">
    <div class="modal-header">
        <button type="button" class="close" ng-click="$close()"
            data-dismiss="modal" aria-hidden="true">×</button>
        <h3 class="modal-title">Advanced</h3>
    </div>
    <div class="modal-body">
        <form class="form-horizontal mc-report-dimenAdv-form">
            <div class="control-group"
                ng-repeat="dimen in dimenAdv.dimensions track by $index">
                <label class="control-label" for="dimension-{{$index}}">
                    {{dimen.name}}</label>
                <div class="controls"
                    ng-init="dimenAdv.nowDimensionsType[$index]=dimenAdv.filterTypes[0]">
                    <select id="dimension-{{$index}}"
                        ng-model="dimenAdv.nowDimensionsType[$index]"
                        ng-options="i for i in dimenAdv.filterTypes"></select>
                    <input type="text"
                        ng-model="dimenAdv.nowDimensionsVal[$index]"
                        ng-show="dimenAdv.nowDimensionsType[$index]">
                </div>
            </div>
        </form>
    </div>
    <div class="modal-footer">
        <a target="_blank">
            <i class="icon-question-sign modal-help"
                rel="tooltip" data-placement="right"
                data-original-title="Help Document">
            </i>
        </a>
        <i ng-show="dimenAdv.filters"
            ng-click="dimenAdv.removeFilters()" class="icon-trash"></i>
        <button class="btn" data-dismiss="modal" ng-click="$close()">Close</button>
        <button class="btn btn-primary" ng-click="dimenAdv.saveFilters()">Save Changes</button>
    </div>

</script>

